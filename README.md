# Astronomikon Imageboard Bot

Бот для публикации изображений с имиджбордов в Telegram-канал.

## Сценарии использования
1) Публикация изображений по ссылке:
   - Пользователь отправляет сообщение со списком ссылок на страницы с допустимых имиджбордов.
   - Бот проверят, установлен ли канал для публикации. Если не установлен, отправляется сообщение, и сценарий прерывается.
   - Бот проверяет формат и количество ссылок (не более 10), в случае нарушения отправляет сообщение. Поддерживаемые сайты с примерами ссылок:  
     - Danbooru: https://danbooru.donmai.us/posts/9836273?q=xena_rai 
     - Betabooru: https://betabooru.donmai.us/posts/9708279?q=shikyou_yoru
   - Бот скачивает изображения:
     - Уведомляет о начале загрузки изображения в формате "Загружаю изображение i/N".
     - Скачивает код страницы.
     - Находит ссылку на полноразмерное изображение. Пример:  
     https://cdn.donmai.us/original/a9/fa/__elizabeth_bathory_fate_and_1_more_drawn_by_fadingz__a9fa86c638721464ef03c8e54b2a0d29.png
     - Скачивает изображение.  
     - Подгоняет размер и разрешение изображения под ограничения:
       - Размер изображения: до 10485760 байт.
       - Сумма сторон: до 10000 точек.
     В случае ошибки на любом из этапов процесс прерывается и пользователю отправляется сообщение.
   - Бот отправляет изображения в канал:
     - Уведомляет о начале отправки изображений в SD.
     - Выполняет запрос `sendMediaGroup` для отправки списка изображений как фото (сжатое разрешение).
     - Уведомляет о начале отправки изображений в HD.
     - Последовательно загружает изображения в полном разрешении на сервер Telegram (загрузка всех изображений одним запросом может превысить лимит 
       по размеру запроса):
       - Выполняет запрос `sendDocument`, получает и запоминает ID загруженного документа.
     - Выполняет запрос `sendMediaGroup` для отправки списка изображений как документы (полное разрешение).
     - Уведомляет об окончании загрузки. 
2) Установка канала для публикации изображений:
   - Пользователь добавляет бота в канал.
   - Пользователь отправляет команду `/setgroup <channel_id>`.
   - Бот сохраняет ID канала в постоянное хранилище.
3) Авторизация пользователей:
   - Пользователь отправляет боту команду.
   - Бот проверяет наличие ID или имени пользователя в списке авторизованных пользователей. 
   При наличии вхождения бот выполняет команду, иначе - отправляет сообщение об отсутствии прав.
